<ng-template #tplComponent let-component>
  <oe-flat-widget-line [name]="component.alias" [value]="component.id"></oe-flat-widget-line>
  @for (d of component.channels; track d) {
    @if (d) {
      <oe-flat-widget-line [name]="'> ' + d.title + ' (' + d.address + ')'" [value]="d.value"
      [converter]="d.converter"></oe-flat-widget-line>
    }
    @if (!d) {
      <oe-flat-widget-line name="> "></oe-flat-widget-line>
    }
  }
</ng-template>


<ion-content>
  <ion-grid>
    <ion-row class="ion-justify-content-center">
      <ion-col size="12" size-sm="12" size-md="10" size="8">
        <ion-item>
          <ion-icon slot="start" size="large" name="information-circle-outline"></ion-icon>
          <ion-text text-nowrap translate>SETTINGS.POWER_ASSISTANT.INFO
          </ion-text>
        </ion-item>
      </ion-col>
    </ion-row>
    @for (entry of entries; track entry) {
      <ion-row class="ion-justify-content-center">
        <ion-col size="12" size-sm="12" size-md="10" size="8">
          <oe-flat-widget [title]="entry.ess.alias">
            <ng-template *ngTemplateOutlet="tplComponent; context: {$implicit: entry.ess}"></ng-template>
            @if (entry.battery) {
              <oe-flat-widget-horizontal-line></oe-flat-widget-horizontal-line>
              <ng-template *ngTemplateOutlet="tplComponent; context: {$implicit: entry.battery}"></ng-template>
            }
            @if (entry.batteryInverter) {
              <oe-flat-widget-horizontal-line></oe-flat-widget-horizontal-line>
              <ng-template *ngTemplateOutlet="tplComponent; context: {$implicit: entry.batteryInverter}"></ng-template>
            }
            <oe-flat-widget-horizontal-line></oe-flat-widget-horizontal-line>
            @for (controller of entry.controllers; track controller) {
              <oe-flat-widget-horizontal-line></oe-flat-widget-horizontal-line>
              <ng-template *ngTemplateOutlet="tplComponent; context: {$implicit: controller}"></ng-template>
            }
          </oe-flat-widget>
        </ion-col>
      </ion-row>
    }
    <ion-row class="ion-justify-content-center">
      <ion-col size="12" size-sm="12" size-md="10" size="8">
        <oe-flat-widget title="Not-implemented Controllers">
          @for (component of ignoredControllers; track component) {
            <oe-flat-widget-line [name]="component.alias"
            [value]="component.id"></oe-flat-widget-line>
          }
        </oe-flat-widget>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
