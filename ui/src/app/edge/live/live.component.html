<oe-navigation-view *ngIf="edge">
  <oe-refresh-view header [refresh]="handleRefresh" [show]="showRefreshDragDown">
    <ion-refresher mode="ios" slot="fixed" (ionRefresh)="handleRefresh($event)">
      <ion-refresher-content refreshingSpinner="crescent"></ion-refresher-content>
    </ion-refresher>
  </oe-refresh-view>
  <ion-grid *ngIf="edge && EDGE.IS_ONLINE && paddingBottom !== null">
    <ion-row class="ion-justify-content-center ion-no-padding" *ngIf="widgets">

      <!-- Left column -->
      <ion-col size="12" [ATTR.SIZE-md]="8" [ATTR.SIZE-lg]="NAVIGATION_SERVICE.POSITION() === 'left' ? 4 : 3"
        class="ion-no-padding">
        <ion-grid class="ion-no-padding">
          <ion-row>
            <ion-col size="12">
              <ng-container *ngFor="let clazz of WIDGETS.CLASSES" [ngSwitch]="clazz">
                <!-- Energymonitor -->
                <energymonitor *ngSwitchCase="'Energymonitor'"></energymonitor>
              </ng-container>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-col>

      <!-- Widgets -->
      <ion-col size="12" size-md="8" size-lg="6" class="ion-no-padding">
        <ion-grid class="ion-no-padding">
          <ion-row>
            <!-- Regular Widgets -->
            <ng-container *ngFor="let clazz of WIDGETS.CLASSES" [ngSwitch]="clazz">

              <ion-col *ngSwitchCase="'Common_Autarchy'" size="12" size-lg="6" class="ion-no-padding">
                <Common_Autarchy></Common_Autarchy>
              </ion-col>

              <ion-col *ngSwitchCase="'Common_Selfconsumption'" size="12" size-lg="6" class="ion-no-padding">
                <Common_Selfconsumption></Common_Selfconsumption>
              </ion-col>

              <ion-col *ngSwitchCase="'Storage'" size="12" size-lg="6" class="ion-no-padding">
                <storage></storage>
              </ion-col>

              <ion-col *ngSwitchCase="'Grid'" size="12" size-lg="6" class="ion-no-padding">
                <grid></grid>
              </ion-col>

              <ion-col *ngSwitchCase="'Common_Production'" size="12" size-lg="6" class="ion-no-padding">
                <Common_Production></Common_Production>
              </ion-col>

              <ion-col *ngSwitchCase="'Consumption'" size="12" size-lg="6" class="ion-no-padding">
                <consumption></consumption>
              </ion-col>

            </ng-container>

            <!-- Widgets depending on the configuration of the OpenEMS Edge -->
            <ng-container *ngFor="let widget of WIDGETS.LIST" [ngSwitch]="WIDGET.NAME">

              <!-- Widgets that are likely to be configured frequently -->

              <ng-container *ngIf="CONFIG.COMPONENTS[WIDGET.COMPONENT_ID].factoryId as factoryId">
                <ng-container
                  *ngIf="factoryId !== 'EVCS.CLUSTER.PEAK_SHAVING' && factoryId !== 'EVCS.CLUSTER.SELF_CONSUMPTION'">
                  <ion-col *ngSwitchCase="'IO.OPENEMS.EDGE.EVCS.API.EVCS'" size="12" size-lg="6" class="ion-no-padding">
                    <Controller_Evcs [componentId]="WIDGET.COMPONENT_ID"></Controller_Evcs>
                  </ion-col>
                </ng-container>
              </ng-container>

              <ion-col *ngSwitchCase="'EVCS.CLUSTER.SELF_CONSUMPTION'" size="12" size-lg="6" class="ion-no-padding">
                <Evcs_Api_Cluster [componentId]="WIDGET.COMPONENT_ID"></Evcs_Api_Cluster>
              </ion-col>

              <ion-col *ngSwitchCase="'EVCS.CLUSTER.PEAK_SHAVING'" size="12" size-lg="6" class="ion-no-padding">
                <Evcs_Api_Cluster [componentId]="WIDGET.COMPONENT_ID"></Evcs_Api_Cluster>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.CHANNEL_THRESHOLD'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Channelthreshold [componentId]="WIDGET.COMPONENT_ID"></Controller_Channelthreshold>
              </ion-col>

              <ion-col *ngSwitchCase="'IO.OPENEMS.IMPL.CONTROLLER.CHANNELTHRESHOLD.CHANNEL_THRESHOLD_CONTROLLER'"
                size="12" size-lg="6" class="ion-no-padding">
                <Controller_Channelthreshold [componentId]="WIDGET.COMPONENT_ID"></Controller_Channelthreshold>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.IO.FIX_DIGITAL_OUTPUT'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Io_FixDigitalOutput [componentId]="WIDGET.COMPONENT_ID"></Controller_Io_FixDigitalOutput>
              </ion-col>

              <ng-container *ngIf="isModbusTcpWidgetAllowed">
                <ion-col *ngSwitchCase="'CONTROLLER.API.MODBUS_TCP.READ_WRITE'" size="12" size-lg="6"
                  class="ion-no-padding">
                  <Controller_Api_ModbusTcp [componentId]="WIDGET.COMPONENT_ID"></Controller_Api_ModbusTcp>
                </ion-col>
              </ng-container>

              <!-- Widgets that are likely to be configured seldomly -->

              <ion-col *ngSwitchCase="'CONTROLLER.CHP.SO_C'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_ChpSocComponent [componentId]="WIDGET.COMPONENT_ID"></Controller_ChpSocComponent>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.IO.HEATING_ELEMENT'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Io_HeatingElement [componentId]="WIDGET.COMPONENT_ID"></Controller_Io_HeatingElement>
              </ion-col>

              <ion-col size="12" *ngSwitchCase="'IO.OPENEMS.EDGE.HEAT.API.MANAGED_HEAT_ELEMENT'" size-lg="6"
                class="ion-no-padding">
                <Controller_Heat [componentId]="WIDGET.COMPONENT_ID"></Controller_Heat>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.IO.HEAT_PUMP.SG_READY'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Io_Heatpump [componentId]="WIDGET.COMPONENT_ID"></Controller_Io_Heatpump>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.SYMMETRIC.PEAK_SHAVING'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Symmetric_PeakShaving [componentId]="WIDGET.COMPONENT_ID">
                </Controller_Symmetric_PeakShaving>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.ASYMMETRIC.PEAK_SHAVING'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Asymmetric_PeakShaving [componentId]="WIDGET.COMPONENT_ID">
                </Controller_Asymmetric_PeakShaving>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.TIMESLOT_PEAKSHAVING'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Symmetric_TimeSlot_PeakShaving [componentId]="WIDGET.COMPONENT_ID">
                </Controller_Symmetric_TimeSlot_PeakShaving>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.ESS.DELAYED_SELL_TO_GRID'" size="12" size-lg="6" class="ion-no-padding">
                <delayedselltogrid [componentId]="WIDGET.COMPONENT_ID"></delayedselltogrid>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.IO.CHANNEL_SINGLE_THRESHOLD'" size="12" size-lg="6"
                class="ion-no-padding">
                <oe-controller-io-channelsinglethreshold
                  [componentId]="WIDGET.COMPONENT_ID"></oe-controller-io-channelsinglethreshold>
              </ion-col>

              <ion-col *ngSwitchCase="'CONTROLLER.ESS.TIME-Of-Use-Tariff'" size="12" size-lg="6" class="ion-no-padding">
                <Controller_Ess_TimeOfUseTariff [componentId]="WIDGET.COMPONENT_ID">
                </Controller_Ess_TimeOfUseTariff>
              </ion-col>

              <ion-col *ngSwitchCase="'IO.OPENEMS.EDGE.IO.API.DIGITAL_INPUT'" size="12" size-lg="6"
                class="ion-no-padding">
                <Io_Api_DigitalInput></Io_Api_DigitalInput>
              </ion-col>

              <ion-col size="12" *ngSwitchCase="'CONTROLLER.ESS.FIX_ACTIVE_POWER'" size-lg="6" class="ion-no-padding">
                <Controller_Ess_FixActivePower [componentId]="WIDGET.COMPONENT_ID"></Controller_Ess_FixActivePower>
              </ion-col>

              <ion-col size="12" *ngSwitchCase="'CONTROLLER.ESS.GRID_OPTIMIZED_CHARGE'" size-lg="6"
                class="ion-no-padding">
                <Controller_Ess_GridOptimizedCharge [componentId]="WIDGET.COMPONENT_ID">
                </Controller_Ess_GridOptimizedCharge>
              </ion-col>
            </ng-container>

          </ion-row>
        </ion-grid>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-grid *ngIf="edge && EDGE.IS_ONLINE && !EDGE.SUBSCRIBE_CHANNELS_SUCCESSFUL">
    <ion-progress-bar type="indeterminate"></ion-progress-bar>
  </ion-grid>

  <ion-grid *ngIf="edge && !EDGE.IS_ONLINE">
    <ion-row class="ion-justify-content-center">
      <ion-col size-xl="8" size-lg="10" size-md="11" size-sm="12">
        <oe-offline></oe-offline>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- </oe-refresh-view> -->
</oe-navigation-view>
