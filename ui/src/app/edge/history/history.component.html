<oe-navigation-view *ngIf="edge">
  <ion-buttons #header header class="ion-justify-content-center">
    <ion-button size="small" fill="clear" class="ion-justify-content-center"
      *ngIf="NAVIGATION_SERVICE.POSITION() !== null && NAVIGATION_SERVICE.POSITION() !== 'disabled'">
      <pickdate></pickdate>
    </ion-button>
  </ion-buttons>
  <ion-refresher mode="ios" slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content refreshingSpinner="crescent"></ion-refresher-content>
  </ion-refresher>
  <oe-history-data-error [response]="errorResponse"></oe-history-data-error>

  <ion-content>

    <!-- Only displayed when history allowed to be seen -->
    <ion-grid *ngIf="isTimedataAvailable && widgets">
      <ion-row>
        <!-- Energymonitor Chart -->
        <ion-col size="12">
          <energy (setErrorResponse)="setErrorResponse($event)" [STYLE.HEIGHT]="energyChartHeight"></energy>
        </ion-col>

        <ng-container *ngFor="let clazz of WIDGETS.CLASSES" [ngSwitch]="clazz">
          <ion-col *ngSwitchCase="'Storage'" size="12" size-md="6" size-lg="4" size-xl="3">
            <common-storage-widget></common-storage-widget>
          </ion-col>
          <ion-col *ngSwitchCase="'Common_Production'" size="12" size-md="6" size-lg="4" size-xl="3">
            <productionWidget></productionWidget>
          </ion-col>
          <ion-col *ngSwitchCase="'Grid'" size="12" size-md="6" size-lg="4" size-xl="3">
            <gridWidget></gridWidget>
          </ion-col>
          <ion-col *ngSwitchCase="'Consumption'" size="12" size-md="6" size-lg="4" size-xl="3">
            <consumptionWidget></consumptionWidget>
          </ion-col>
          <ion-col *ngSwitchCase="'Common_Selfconsumption'" size="12" size-md="6" size-lg="4" size-xl="3">
            <selfconsumptionWidget></selfconsumptionWidget>
          </ion-col>
          <ion-col *ngSwitchCase="'Common_Autarchy'" size="12" size-md="6" size-lg="4" size-xl="3">
            <autarchyWidget></autarchyWidget>
          </ion-col>

          <!-- Non-Common but showing only one widget for all components -->
          <ion-col *ngSwitchCase="'Controller_ChannelThreshold'" size="12" size-md="6" size-lg="4" size-xl="3">
            <channelthresholdWidget>
            </channelthresholdWidget>
          </ion-col>
          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'Controller_Io_Digital_Outputs'">
            <DigitalOutputWidget>
            </DigitalOutputWidget>
          </ion-col>
        </ng-container>

        <ng-container *ngFor="let widget of WIDGETS.LIST" [ngSwitch]="WIDGET.NAME">

          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.SYMMETRIC.PEAK_SHAVING'">
            <oe-controller-peakshaving-symmetric [componentId]="WIDGET.COMPONENT_ID">
            </oe-controller-peakshaving-symmetric>
          </ion-col>
          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.ASYMMETRIC.PEAK_SHAVING'">
            <oe-controller-peakshaving-asymmetric
              [componentId]="WIDGET.COMPONENT_ID"></oe-controller-peakshaving-asymmetric>
          </ion-col>
          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.TIMESLOT_PEAKSHAVING'">
            <oe-controller-peakshaving-timeslot [componentId]="WIDGET.COMPONENT_ID">
            </oe-controller-peakshaving-timeslot>
          </ion-col>

          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.ESS.DELAYED_SELL_TO_GRID'">
            <delayedSellToGridWidget [componentId]="WIDGET.COMPONENT_ID"></delayedSellToGridWidget>
          </ion-col>

          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.ESS.GRID_OPTIMIZED_CHARGE'">
            <gridOptimizedChargeWidget [componentId]="WIDGET.COMPONENT_ID">
            </gridOptimizedChargeWidget>
          </ion-col>

          <ng-container *ngIf="isModbusTcpWidgetAllowed">
            <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.API.MODBUS_TCP.READ_WRITE'">
              <modbusTcpApiWidget [componentId]="WIDGET.COMPONENT_ID">
              </modbusTcpApiWidget>
            </ion-col>
          </ng-container>

          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.ESS.TIME-Of-Use-Tariff'">
            <timeOfUseTariffWidget [componentId]="WIDGET.COMPONENT_ID">
            </timeOfUseTariffWidget>
          </ion-col>

          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.IO.HEATING_ELEMENT'">
            <controller-io-heatingelement-widget [componentId]="WIDGET.COMPONENT_ID">
            </controller-io-heatingelement-widget>
          </ion-col>

          <ion-col size="12" size-md="6" size-lg="4" size-xl="3"
            *ngSwitchCase="'IO.OPENEMS.EDGE.HEAT.API.MANAGED_HEAT_ELEMENT'">
            <controller-heat-widget [componentId]="WIDGET.COMPONENT_ID">
            </controller-heat-widget>
          </ion-col>

          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.IO.HEAT_PUMP.SG_READY'">
            <controller-io-heatpump-widget [componentId]="WIDGET.COMPONENT_ID">
            </controller-io-heatpump-widget>
          </ion-col>
          <ion-col size="12" size-md="6" size-lg="4" size-xl="3" *ngSwitchCase="'CONTROLLER.CHP.SO_C'">
            <chpsocWidget [componentId]="WIDGET.COMPONENT_ID" [period]="SERVICE.HISTORY_PERIOD.VALUE">
            </chpsocWidget>
          </ion-col>
        </ng-container>
      </ion-row>
    </ion-grid>

    <ion-grid *ngIf="!isTimedataAvailable">
      <ion-row class="ion-justify-content-center">
        <ion-col size="12" size-md="8">
          <ion-card>
            <ion-item lines="full" color="light">
              <ion-icon slot="start" size="large" color="warning" name="information-circle-outline"></ion-icon>
              <ion-label class="ion-text-wrap">Historische Daten sind derzeit lokal nicht verf√ºgbar</ion-label>
            </ion-item>
            <ion-card-content>
              <p>Please setup a Timeseries provider like "Timedata InfluxDB" to record and visualize historic data.</p>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-content>
</oe-navigation-view>
